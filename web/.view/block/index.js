 (function() { function template(locals) {var pug_html = "", pug_mixins = {}, pug_interp;pug_html = pug_html + "\u003Cdiv class=\"geoevent default loading\"\u003E\u003Cstyle type=\"text\u002Fcss\"\u003E:scope{width:100%;height:100%}.dimmer{position:absolute;top:0;left:0;z-index:1;display:none;background:#808080 url(\"..\u002Fassets\u002Fimg\u002Fblurmap.jpg\") center center no-repeat;background-size:cover;width:100%;height:100%;text-align:center;vertical-align:middle;line-height:100%;color:#123}.dimmer:before{content:\" \";display:inline-block;height:50%;width:0}:scope.loading .dimmer{display:block}\u003C\u002Fstyle\u003E\u003Cscript type=\"@plotdb\u002Fblock\"\u003Emodule.exports={init:function(t){var e,u,h;e=t.root;u=e.querySelector(\".eventmap\");h={onAdd:function(t,e){var n;n=$(\"#zm-event .bubbles\")[0];n.parentNode.removeChild(n);return e.appendChild(n)},draw:function(i,t){var s;s=Math.pow(2,t.getZoom()-6);return $scope.events.map(function(t,e){var n;t.x=(n=i.ll2p(t.lat,t.lng)).x;t.y=n.y;return t.rate=s})}};this.state=1;this.speed=3;this.dir=1;this.loaded=\"loading\";this.style=\"default\";this.dim={width:0,height:0,wtype:\"w-md\",htype:\"h-md\",timelineHeight:300};this.resize=function(){var t,e,n;t=[u.width(),u.height()],e=t[0],n=t[1];t=this.dim;t.width=e;t.height=n;this.dim.wtype=e\u003C=480?\"w-mc\":e\u003C=768?\"w-xs\":e\u003C=991?\"w-sm\":e\u003C=1199?\"w-md\":\"w-lg\";this.dim.htype=n\u003C=240?\"h-mc\":n\u003C=320?\"h-xs\":n\u003C=480?\"h-sm\":n\u003C=600?\"h-md\":\"h-lg\";return this.dim.timelineHeight={\"h-mc\":120,\"h-xs\":140,\"h-sm\":200,\"h-md\":300,\"h-lg\":300}[this.dim.htype]};this.reset=function(n){n==null&&(n=false);this.events.top=5;this.stepCount=0;return this.events.map(function(t,e){t.fadeout=1;t.opacity=.8;t.size=0;t.circle_opacity=0;t.bubble={};t.first=false;if(!n){return t.top=e*50}})};this.setStyle=function(t){return this.map.set(\"styles\",mapStyle[this.style=t])};this.play=function(){return this.state=1,this.dir=1,this};this.pause=function(){return this.state=0};this.speeding=function(){return this.speed=this.speed%3+1};this.step=function(t){if(t!==this.dir){this.events.map(function(t,e){return t.bubble={state:0},t.size=0,t.circle_opacity=0,t})}return this.dir=t,this.state=2,this};this.initData=function(){};return this.initData2=function(){var o,t,e,n,i,s,a=this;o={src:\"1yY4pqGqI3rLMf5bQqe5XMztnnJ78RMUrfh-XpJdhd_o\",color:\"default\",ratio:1};((window.location.search||\"\").split(\"?\").filter(function(t){return t})[0]||\"\").split(\"&\").map(function(t){var e;e=t.split(\"=\");return o[e[0]]=e[1]});this.currentURL=(t=o.currentURL)?t:(e=function(){var t,e=[];for(n in t=o){i=t[n];e.push([n,i])}return e}().filter(function(t){return t[0]&&typeof t[1]!==\"undefined\"}).map(function(t){return t[0]+\"=\"+encodeURIComponent(t[1])}).join(\"&\"),\"http:\u002F\u002F0media.tw\u002Ft\u002Fgeoevent\u002Fwidget\u002F?\"+e);s=\"https:\u002F\u002Fspreadsheets.google.com\u002Ffeeds\u002Fworksheets\u002F\"+o.src+\"\u002Fpublic\u002Ffull?alt=json\";return ld$.fetch(s,{method:\"GET\"},{type:\"json\"}).then(function(t){return a.title=t.feed.title.$t}).then(function(){var t;t=\"https:\u002F\u002Fspreadsheets.google.com\u002Ffeeds\u002Flist\u002F\"+o.src+\"\u002F1\u002Fpublic\u002Fvalues?alt=json\";return ld$.fetch(t,{method:\"GET\"},{type:\"json\"})}).then(function(e){var l,n,p,s,t,i,r;l=function(){var t=[];for(n in e.feed.entry[0]){t.push(n)}return t}().map(function(t){return\u002F^gsx\\$mag1-(.+)$\u002F.exec(t)}).filter(function(t){return t})[0];p=function(){var t=[];for(n in e.feed.entry[0]){t.push(n)}return t}().map(function(t){return\u002F^gsx\\$mag2-(.+)$\u002F.exec(t)}).filter(function(t){return t})[0];a.mag1=l?l[1]:\"death\";a.mag2=p?p[1]:\"hurt\";l=l?l[0]:\"gsx$death\";p=p?p[0]:\"gsx$wounded\";return;s=e.feed.entry.map(function(t){var e,n,i,s,r,o,a,u,h;e=t[\"gsx$date\"].$t.replace(\u002F[年月]\u002Fg,\"\u002F\");e=e.replace(\u002F[日]\u002Fg,\"\");n=new Date(e);i=n.getMonth()+1;e=n.getYear()+1900+\"\u002F\"+(i\u003C10?\"0\":\"\")+i;s={mag1:parseInt((t[l]||(t[l]={})).$t||0),mag2:parseInt((t[p]||(t[p]={})).$t||0)};s.total=s.mag1+s.mag2;s.radius=parseInt(Math.sqrt(s.total))*3+10;r=parseFloat(t[\"gsx$latitude\"].$t||0);o=parseFloat(t[\"gsx$longitude\"].$t||0);a=(t[\"gsx$shortname\"].$t||t[\"gsx$event\"].$t).trim();u=new google.maps.LatLng(r,o);h={name:a,dateFull:n,magsum:s,lat:r,lng:o,loc:u,date:e};return h});s=s.filter(function(t){return t.lat&&t.lng&&t.magsum.total});t=s.map(function(t){return parseFloat(t.lat)}).sort(function(t,e){return t-e});i=s.map(function(t){return parseFloat(t.lng)}).sort(function(t,e){return t-e});a.stepCount=0;r=function(){var t,e,n,i;if(a.state){t=s[a.stepCount+a.dir];if(t){t.circle_opacity=1;t.bubble.state=1;t.size=t.magsum.radius*t.rate*o.ratio}if(t){a.current=t}e=s[a.stepCount];if(e){e.bubble.state=2}n=s[a.stepCount-a.dir];if(n){n.circle_opacity=0}a.events.top=(a.events.top||5)-50*a.dir;if(a.events.top\u003E5){a.events.top=5;a.state=0}if(a.events.top\u003C5-(a.events.length-1)*50){a.events.top=5-(a.events.length-1)*50;a.state=0}a.stepCount+=a.dir;a.stepCount\u003E=0||(a.stepCount=0);a.stepCount\u003C=(i=a.events.length-1)||(a.stepCount=i)}if(a.state===2){a.state=0}return setTimeout(r,[1600,800,300][a.speed-1])};setTimeout(r,0);a.events=s;a.reset();a.map=map.init(u[0],[t[0],t[t.length-1]],[i[0],i[i.length-1]],resize,h,o);a.setStyle(o.color);a.loaded=\"\";return setTimeout(resize,0)})}}};\u003C\u002Fscript\u003E\u003Cdiv class=\"main-title\" ld=\"title\"\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"dimmer\"\u003E\u003Cimg src=\"assets\u002Fimg\u002Fspin.gif\"\u003E\u003Cdiv class=\"mt-2\"\u003EPreparing the timeline\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"timeline\"\u003E\u003Cdiv class=\"timeline-inner\"\u003E\u003Cdiv class=\"header\"\u003E\u003Cdiv class=\"name\" ld=\"name\"\u003E\u003C\u002Fdiv\u003E\u003C!-- {{current.magsum.mag1}}{{mag1}}--\u003E\u003Cdiv class=\"magsum\" ld=\"mag\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"background\"\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"line-wrap\"\u003E\u003Cdiv class=\"line\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"events\"\u003E\u003Cdiv class=\"events-inner\" ld=\"event-list\"\u003E\u003Cdiv class=\"event\" ld-each=\"event\"\u003E\u003Cdiv class=\"circle\" ld=\"circle\"\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"desc\"\u003E\u003Cdiv class=\"data\" ld=\"date\"\u003E\u003C\u002Fdiv\u003E\u003Cdiv class=\"name\" ld=\"name\"\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E\u003C\u002Fdiv\u003E";;return pug_html;}; module.exports = template; })() 